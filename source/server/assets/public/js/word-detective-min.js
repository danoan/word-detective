var e={};function t(){let e=[],t=[],n=new Set;return{missing_words:e,words_found:t,words_revealed:n,add_found_word:function(n){t.push(n),e.splice(e.indexOf(n),1)},add_missing_word:function(t){e.push(t)},is_it_missing_word:function(t){for(let n of e)if(n===t)return!0;return!1},mark_as_revealed:function(e){n.add(e)},is_revealed:function(e){return n.has(e)}}}function n(e){return{init:function(){e.set_display_value("")},erase_letter:function(){let t="",n=e.get_display_value();t=n.length>=1?n.substring(0,n.length-1):"",e.set_display_value(t)},click_letter:function(t){let n=e.get_display_value();n.length<=30&&(n+=t),e.set_display_value(n)},get_user_input_word:function(){return e.get_display_value()},reset:function(){}}}function i(e){let t=[];function n(e,t,n){let i=e.substring(0,t)+n;return i+=e.substring(t+1),i}return{init:function(n){let i="";t=[];for(let e=0;e<n.length;++e)e%2==0?i+=n[e]:(i+="_",t.push(e));e.set_display_value(i)},erase_letter:function(){let i=e.get_display_value(),o=t;for(let e=o.length-1;e>=0;--e){let s=o[e];if(s<0){i=n(i,-s,"_"),t[e]=-s;break}}e.set_display_value(i)},click_letter:function(i){let o=e.get_display_value(),s=t;for(let e=0;e<s.length;++e){let l=s[e];if(l>=0){o=n(o,l,i),t[e]=-l;break}}e.set_display_value(o)},get_user_input_word:function(){return e.get_display_value()},reset:function(){}}}function o(e){let t=[i(e)],n=0;function o(){return t[n]}return{init:function(e){return o().init(e)},erase_letter:function(){return o().erase_letter()},click_letter:function(e){return o().click_letter(e)},get_user_input_word:function(){return o().get_user_input_word()},next_handler:function(){return n+=1,n!=t.length||(n=0,!1)},add_hint_handler:function(n){t.push(n(e))},reset:function(){n=0}}}function s(e,t){return{update_missing_words_count:function(t,n){e.set_missing_words_value(`${t}/${t+n}`)},valid_word_message:function(n){switch(n){case"super-easy":e.set_status_value(`${t.super_easy_word_message}`);break;case"easy":e.set_status_value(`${t.easy_word_message}`);break;case"average":e.set_status_value(`${t.average_difficult_word_message}`);break;case"quite-difficult":e.set_status_value(`${t.quite_difficult_word_message}`);break;case"difficult":e.set_status_value(`${t.difficult_word_message}`);break;case"super-difficult":e.set_status_value(`${t.super_difficult_word_message()}`);break;default:e.set_status_value(`${t.valid_word_message}`)}},word_found_already_message:function(){e.set_status_value(`${t.word_found_already_message}`)},word_too_short_message:function(){e.set_status_value(`${t.word_too_short_message}`)},word_not_in_word_source_message:function(){e.set_status_value(`${t.word_not_in_word_source_message}`)}}}e.d=(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);let l={callbacks:{init:null,click_letter:null,erase_letter:null,check_word:null,hint:null,end:null,flag_word:null},hint_display_behaviour:"by_request"};let r=function(){let e=!1;function t(){e=!1}return function(n){return n.unblock=t,function(){e||(e=!0,n.apply(this,arguments))}}}();function a(e){return{get:function(t){return fetch(`/api/${e}/definition-chatgpt/${t}`).then(e=>e.json()).then(e=>new Promise((t,n)=>{e.definition?t({word:e.word,definition:e.definition}):n(new Error("ChatGPT dictionary failed"))}))}}}let d={callbacks:{init:null,pre_slide_left:null,slide_left:null,pre_slide_right:null,slide_right:null}};function _(e){let t=null,n=null;function i(){t&&(t.style.display="none",n=null)}return{show_popup:function(o,s){if(s.classList.contains("word-flagged"))return;t||function(){t=document.createElement("div"),t.className="flag-popup",t.style.display="none";let o=document.createElement("span");o.className="flag-popup-text",o.textContent="Report word?";let s=document.createElement("button");s.className="flag-popup-btn",s.textContent="Flag",s.addEventListener("click",function(o){o.stopPropagation(),function(){let o=t.dataset.word,s=n;i(),s&&s.classList.add("word-flagged"),fetch(`/api/${e}/flag-word/${encodeURIComponent(o)}`,{method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log("[word-flag]",e)}).catch(function(e){console.error("[word-flag] Error:",e)})}()}),t.appendChild(o),t.appendChild(s),document.body.appendChild(t),document.addEventListener("click",function(){i()})}(),n=s,t.dataset.word=o;let l=s.getBoundingClientRect();t.style.display="flex",t.style.left=l.left+"px",t.style.top=l.bottom+4+"px"}}}function u(){let e={slider_container:document.getElementById("evidence-list"),next_button_element:document.getElementById("slide-next-button")};return{slider_container:e.slider_container,next_button:e.next_button_element,previous_button:null}}function c(){let e={word_list:document.getElementById("evidence-list-words"),word_list_container:document.getElementById("evidence-list"),overlay:document.getElementById("evidence-list-overlay")};return{display_word_list:function(){e.word_list_container.style.display="block",e.overlay.style.display="block"},hide_word_list:function(){e.word_list_container.style.display="none",e.overlay.style.display="none"},add_to_word_list:function(t,n){let i=document.createElement("li");return i.onclick=function(){n(i)},i.innerHTML=t,e.word_list.append(i),i}}}function f(){let e={display:document.getElementById("display-text"),status:document.getElementById("bottom-status"),word_list:document.getElementById("words-list"),missing_words:document.getElementById("missing-words")},t=document.createElement("div");function n(t,n=null){let i=document.createElement("span");n&&(i.style.color=n),i.innerHTML=t,e.display.appendChild(i)}function i(){let n=Array.from(e.display.children);for(let i of n)i!==t&&e.display.removeChild(i)}function o(){for(;e.word_list.childElementCount>0;)e.word_list.removeChild(e.word_list.childNodes[0])}return t.className="reveal-button",e.display.appendChild(t),{set_display_value:function(e,t=null){i(),n(e,t)},append_display_value:n,get_display_value:function(){if(e.display.childElementCount>0)for(let n of e.display.children)if(n!==t)return n.innerHTML;return""},clear_display_value:i,set_status_value:function(t){e.status.innerHTML=t},get_status_value:function(t){return e.status.innerHTML},clear_status_value:function(){e.status.innerHTML=""},set_missing_words_value:function(t){e.missing_words.innerHTML=t},get_missing_words_value:function(t){return e.missing_words.innerHTML},clear_missing_words_value:function(){e.missing_words.innerHTML=""},add_to_word_list:function(t,n,i){let o=document.createElement("li");o.append(t),o.style.animationName="new-word",o.style.animationDuration="0.5s",n&&o.classList.add("word-revealed"),i&&(o.style.cursor="pointer",o.addEventListener("click",function(e){e.stopPropagation(),i(t,o)})),e.word_list.childNodes.length>0?e.word_list.insertBefore(o,e.word_list.childNodes[0]):e.word_list.append(o)},clear_word_list:o,show_reveal_button:function(){t.style.display="block"},hide_reveal_button:function(){t.style.display="none"},reveal_button:t,reset:function(){o()}}}let g={words_found_cookie_id:"",iso_expiration_date:"",onload:null,load_assets:null,default_error_handler:e=>alert(e),fatal_error_handler:null,language:"en",enable_word_request:!0},w=function(e,t){return{get:()=>function(e){let t=e+"=",n=decodeURIComponent(document.cookie).split(";");for(let e=0;e<n.length;e++){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""}(e),set:n=>function(e,t,n){let i="";n&&(i="expires="+new Date(n).toUTCString()),document.cookie=e+"="+t+";"+i+"domain=192.168.1.22;path=/;SameSite=Lax;"}(e,n,t)}};function m(e=!1){let i=(m=g.words_found_cookie_id,h=g.iso_expiration_date,w(m,h));var m,h;let p=function(e,t){let n,i=function(e){const t="word-selected",n="word-unselected";function i(e){e.classList.remove(t),e.classList.add(n)}return{show_word_list:function(t,n){for(let o of t)i(e.add_to_word_list(o,n));e.display_word_list()},is_selected:function(e){return e.classList.contains(t)},unselect:i,select:function(e){e.classList.remove(n),e.classList.add(t)}}}(t),o={length:0};function s(e){i.is_selected(e)?(i.unselect(e),delete o[e.innerHTML],o.length--):o.length<3&&(i.select(e),o[e.innerHTML]=!0,o.length++)}return n="it"===e?{get:function(e){return fetch(`/api/it/definition/${e}`).then(e=>e.json()).then(e=>{if(e.definition)return{word:e.word,definition:e.definition};throw new Error("No definition found")})}}:"fr"===e?a("fr"):"pt"===e?a("pt"):{get:function(e){return fetch(`/api/en/definition/${e}`).then(e=>e.json()).then(e=>{if(e.definition)return{word:e.word,definition:e.definition};throw new Error("No definition found")})}},{display_word_list:function(e){i.show_word_list(e,s)},select_word:s,get_word_definition:function(e){return n.get(e)},get_selected_words:function(){let e=[];for(let t in o)"length"!==t&&e.push(t);return e},num_selected_words:function(){return o.length}}}(g.language,c()),b=function(){let e={callbacks:{}};return e.callbacks.pre_slide_left=function(e){if(0===e){let e=5;b.set_next_slide_number(e-p.num_selected_words()-2)}},e.callbacks.slide_left=function(){let e=0;return function(t,n){if(!n){let n=p.get_selected_words()[e++];p.get_word_definition(n).then(function(e){t.children[0].innerHTML=e.word,t.children[1].innerHTML=e.definition},function(e){g.default_error_handler(e)})}}}(),function(e,t){null===t&&(t=d);let n=function(e){const t="slide",n="slide-hidden-right",i="slide-show",o="visible-button",s="hidden-button";let l=[];for(let n of e.slider_container.children)n.classList.contains(t)&&l.push(n);function r(e,t,n){e.classList.remove(t),e.classList.add(n)}return{get_slides_containers:()=>l,set_html_element_as_slide:function(e){e.classList.add(t)},hide_slide:function(e){e.classList.add(n)},transition_left_to_right:function(e){r(e,n,i)},transition_right_to_left:function(e){r(e,i,"slide-hidden-left")},hide_button:function(e){null!==e&&r(e,o,s)},show_button:function(e){null!==e&&r(e,s,o)}}}(e),i=n.get_slides_containers(),o=0;function s(){0===o?n.hide_button(e.previous_button):n.show_button(e.previous_button),o===i.length-1?n.hide_button(e.next_button):n.show_button(e.next_button)}function l(){t.callbacks.pre_slide_left&&t.callbacks.pre_slide_left(o);let e=o+1;if(e>=i.length)return;let l=i[o],r=i[e],a=e===i.length-1;t.callbacks.slide_left&&t.callbacks.slide_left(r,a),n.transition_right_to_left(l),n.transition_left_to_right(r),o=e,s()}function r(){t.callbacks.pre_slide_right&&t.callbacks.pre_slide_right(o);let e=o-1;if(e<0)return;let l=i[o],r=i[e],a=0===e;t.callbacks.slide_right&&t.callbacks.slide_right(r,a),n.transition_left_to_right(l),n.transition_right_to_left(r),o=e,s()}return function(){for(let e of i)n.set_html_element_as_slide(e),n.hide_slide(e);n.transition_left_to_right(i[0]),s(),null!==e.next_button&&(e.next_button.onclick=l),null!==e.previous_button&&(e.previous_button.onclick=r),t.callbacks.init&&t.callbacks.init()}(),{slide_left:l,slide_right:r,set_next_slide_number:function(e){let t=i[o];n.transition_right_to_left(t),o=e}}}(u(),e)}(),y=null;g.enable_word_request&&(y=function(e,t){let n;return{request_word:function(i){clearTimeout(n),t.request_word_mode(),t.show_request_word_bar(i),t.requested_word.onclick=function(){return clearTimeout(n),o=!0,t.requested_word.onclick=null,t.success_message_mode(),n=setTimeout(()=>{t.hide_request_word_bar()},1500),fetch(`/api/${e}/request-word/${i}`).then(e=>e.json()).then(e=>new Promise(function(t,n){console.log(e),!0===e.Success?t(e):n(new Error("The word could not be requested."))}))};let o=!1;n=setTimeout(()=>{!1===o&&(t.requested_word.onclick=null,t.hide_request_word_bar())},5e3)}}}(g.language,function(){let e={requested_word:document.getElementById("requested-word"),request_word_container:document.getElementById("container-request-word"),notification_bar:document.getElementById("container-notification-bar"),success_message:document.getElementById("container-request-word-success-message")};return{show_request_word_bar:function(t){e.requested_word.innerHTML=t,e.notification_bar.style.animationName="show-notification-bar",e.notification_bar.style.animationDuration="1s",e.notification_bar.style.animationFillMode="forwards"},hide_request_word_bar:function(){e.notification_bar.style.animationName="hide-notification-bar",e.notification_bar.style.animationDuration="1s",e.notification_bar.style.animationFillMode="forwards"},success_message_mode:function(){e.notification_bar.style.display="block",e.success_message.style.display="block",e.request_word_container.style.display="none"},request_word_mode:function(){e.notification_bar.style.display="block",e.success_message.style.display="none",e.request_word_container.style.display="block"},requested_word:e.requested_word}}()));let v=_(g.language);return null!==g.onload&&g.onload(),g.load_assets().then(t=>new Promise(function(n){let i=k(t);e&&(i.ephemeral={gui_slider:u,gui_word_definition:c,gui_WORD_DETECTIVE_api:f}),n(i)}));function k(e){let a={callbacks:{}};return g.hint_display_behaviour&&(a.hint_display_behaviour=g.hint_display_behaviour),a.callbacks.check_word=function(e){(function(e,t){let n="";e().forEach(e=>{if(e.length>0){let i=t(e)?":R":"";n+=e+i+","}}),i.set(n)})(e.get_words_found,e.is_revealed),e.callback_status===e.callback_status_values.UNRECOGNIZED_WORD&&null!==y&&y.request_word(e.word)},a.callbacks.init=t=>function(e,t){!function(e){let t=1;for(let n of e.letters){let e=document.createElement("div"),i=document.createElement("div");e.className=`hexagon hexagon-pos-${t}`,e.onclick=()=>control.click_letter(n),i.className="letter-hex",i.innerHTML=n,e.appendChild(i),document.getElementById("container-hexagons").appendChild(e),t+=1}}(e);for(let n of e.words)t.add_missing_word(n);!function(e){i.get().split(",").forEach(t=>{if(t.length>0){let n=t.endsWith(":R"),i=n?t.slice(0,-2):t;e.add_found_word(i,n)}})}(t)}(e.puzzle,t),a.callbacks.end=function(e){p.display_word_list(e.get_words_found())},a.callbacks.flag_word=(e,t)=>v.show_popup(e,t),function(e,i,a){e.reset();let d={...l};for(let e in a.callbacks)d.callbacks[e]=a.callbacks[e];a.hint_display_behaviour&&(d.hint_display_behaviour=a.hint_display_behaviour);let _=function(e){function t(e){let t=e.length,n=Math.trunc(Math.random()*t);return e[Math.min(n,t-1)]}return e.super_easy_word_message=t(e.super_easy_word_message),e.easy_word_message=t(e.easy_word_message),e.average_difficult_word_message=t(e.average_difficult_word_message),e.quite_difficult_word_message=t(e.quite_difficult_word_message),e.difficult_word_message=t(e.difficult_word_message),e.super_difficult_word_message=function(){return`${t(e.author_prefix_message)}     ${t(e.authors)}     ${t(e.author_suffix_message)}\n    `},e}(i),u=d.callbacks,c={normal_mode:n(e),hint_mode:o(e),messages:s(e,_)},f={word:{get_difficulty:function(e){let t=e.length,n=0,i=function(e){let t={};for(let n of e)n in t?t[n]+=1:t[n]=0;return t}(e);for(let e in i)n+=i[e];return 4===t&&0===n?"super-easy":4===t&&n>0||5===t&&0===n?"easy":5===t&&1===n?"average":6===t&&0===n?"easy":6===t&&1===n?"average":6===t&&n>1||7===t&&0===n?"quite-difficult":7===t&&1===n||7===t&&2===n?"difficult":7===t&&n>2||n>=3?"super-difficult":"quite-difficult"}},data:t()},g={MISSING_WORD:Symbol("Missing Word"),REJECTED_WORD:Symbol("Rejected Word"),UNRECOGNIZED_WORD:Symbol("Unregcognized Word")};function w(t,n){n&&f.data.mark_as_revealed(t),f.data.add_found_word(t),e.add_to_word_list(t,n,u.flag_word||null)}function m(e){f.data.add_missing_word(e)}function h(...e){let t={add_missing_word:m,add_found_word:w,get_words_found:()=>[...f.data.words_found],get_missing_words:()=>[...f.data.missing_words],is_revealed:e=>f.data.is_revealed(e)};return Object.assign(t,...e)}let p,b=c.normal_mode;u.init(h()),c.messages.update_missing_words_count(f.data.words_found.length,f.data.missing_words.length),"always_visible"===d.hint_display_behaviour&&e.show_reveal_button();let y={click_letter:r(function e(...t){b.click_letter(...t),e.unblock(),null!==u.click_letter&&u.click_letter(h())}),erase_letter:r(function e(...t){b.erase_letter(...t),e.unblock(),null!==u.erase_letter&&u.erase_letter(h())}),check_word:r(function t(){clearTimeout(p);let n=b.get_user_input_word(),i=null;f.data.is_it_missing_word(n)?(w(n),"always_visible"!==d.hint_display_behaviour&&(b.reset(),b=c.normal_mode,e.hide_reveal_button()),c.messages.valid_word_message(f.word.get_difficulty(n)),c.messages.update_missing_words_count(f.data.words_found.length,f.data.missing_words.length),i=g.MISSING_WORD):n.length<=3?(c.messages.word_too_short_message(),i=g.REJECTED_WORD):f.data.words_found.find(e=>e===n)?(c.messages.word_found_already_message(),i=g.REJECTED_WORD):(c.messages.word_not_in_word_source_message(),i=g.UNRECOGNIZED_WORD),null!==u.check_word&&u.check_word(h({callback_status_values:g,callback_status:i,word:n})),b.init(f.data.missing_words[0]),t.unblock(),p=setTimeout(()=>{e.clear_status_value(),0===f.data.missing_words.length&&u.end(h())},2e3)}),hint:r(function t(){b===c.normal_mode?(b=c.hint_mode,e.show_reveal_button()):b===c.hint_mode&&(c.hint_mode.next_handler()||(b=c.normal_mode,e.hide_reveal_button())),b.init(f.data.missing_words[0]),t.unblock(),null!==u.hint&&u.hint(h())}),reveal_word:r(function t(){clearTimeout(p);let n=f.data.missing_words[0];n?(w(n,!0),"always_visible"!==d.hint_display_behaviour&&(b.reset(),b=c.normal_mode,e.hide_reveal_button()),c.messages.update_missing_words_count(f.data.words_found.length,f.data.missing_words.length),null!==u.check_word&&u.check_word(h({callback_status_values:g,callback_status:g.MISSING_WORD,word:n})),b.init(f.data.missing_words[0]),t.unblock(),p=setTimeout(()=>{e.clear_status_value(),0===f.data.missing_words.length&&u.end(h())},2e3)):t.unblock()}),add_hint_handler:c.hint_mode.add_hint_handler};return e.reveal_button.onclick=y.reveal_word,y}(f(),e.messages,a)}}export{g as config,w as cookie_manager,m as main};